<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="../img/logo.png" type="image/x-icon" />
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"
      integrity="sha512-zoJXRvW2gC8Z0Xo3lBbao5+AS3g6YWr5ztKqaicua11xHo+AvE1b0lT9ODgrHTmNUxeCw0Ry4BGRYZfXu70weg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>choose the mode</title>
    <script></script>
  </head>

  <body>
    <div class="container">
      <div class="pop-up">
        <h1>Play Online</h1>
        <div id="game" style="display: block">
          <div class="comp">
            <!--player-->

            <div class="player">
              <div class="phealth">
                <div id="Pname"></div>
              </div>
              <div id="ol-heal"></div>
            </div>
            <!--timer-->

            <div id="timer"></div>

            <!--enemy-->
            <div class="enemy">
              <div class="ehealth">
                <div id="Ename"></div>
              </div>
              <div id="en-heal"></div>
            </div>
          </div>
          <canvas style="border: 7px solid wheat"></canvas>
          <div class="creator">
            <div class="ver" style="padding: 5px">V:3.5</div>
            contact:<a
              style="text-decoration: none; color: #68c1c4"
              href="mailto:zeyadnagi421@gmail.com"
              >ZEYAD_M_NAGI</a
            >
          </div>
        </div>
        <div class="opening">
          <div id="input">
            <div class="enterName">
              <p class="name">Enter Your Name:</p>
              <input
                type="text"
                placeholder="Name"
                id="name"
                autocomplete="off"
              />
            </div>
            <div class="character">
              <h3>Choose your character</h3>
              <div class="img">
                <img
                  id="p1"
                  src="../img/img/p1/preview.png"
                  onclick="choose1( this)"
                  alt="wizard"
                />
                <img
                  src="../img/img/p3/preview.png"
                  id="p3"
                  class="wow"
                  alt="electric sword"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p5/preview.png"
                  id="p5"
                  alt="ninja"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p7/preview.png"
                  id="p7"
                  alt="the King"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p13/Idle (2).png"
                  alt="evil wizard"
                  id="p13"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p15/Idle (2).png"
                  alt="knight"
                  id="p15"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p9/preview.png"
                  alt="fire wizard"
                  id="p9"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p17/preview.png"
                  alt="goblin"
                  id="p17"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p19/preview.png"
                  alt="skeleton"
                  id="p19"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p25/crystal_mauler.png"
                  style="scale: 0.7"
                  alt="crystal"
                  id="p25"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p27/wind_hashashin.png"
                  style="scale: 0.7"
                  alt="wind"
                  id="p27"
                  onclick="choose1(this)"
                />
                <img
                  src="../img/img/p21/preview.png"
                  alt="green"
                  id="p21"
                  onclick="choose1(this)"
                />
              </div>
            </div>
            <button
              id="find"
              onclick="find(document.getElementById('name'),this)"
            >
              Find a player
            </button>
            <img
              style="display: none"
              src="../img/spinner2.gif"
              id="loading"
              alt="loading"
            />
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"
      integrity="sha512-H6cPm97FAsgIKmlBA4s774vqoN24V5gSQL4yBTDOY2su2DeXZVhQPxFK4P6GPdnZqM9fg1G3cMv5wD7e6cFLZQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script defer src="../two-player/the main/js/character.js"></script>
    <script defer src="../two-player/the main/js/classes.js"></script>
    <script defer src="js/fun.js"></script>
    <script defer src="js/faces.js"></script>
    <script defer src="js/controllar.js"></script>
    <script defer src="js/canvas.js"></script>
    <script>
      var character;
      var choices = document.querySelectorAll(".img img");
      function choose1(element) {
        Array.from(choices).forEach((child) => {
          child.style.border = "unset";
        });
        element.style.border = "5px solid #fff";
        playerid = element.id;
        if (playerid === "p1") {
          character = wizard_1;
        } else if (playerid === "p3") {
          character = warrior_1;
        } else if (playerid === "p5") {
          character = samurai_1;
        } else if (playerid === "p7") {
          character = king_1;
        } else if (playerid === "p13") {
          character = evil_1;
        } else if (playerid === "p15") {
          character = knight_1;
        } else if (playerid === "p9") {
          character = fire_wizard_1;
        } else if (playerid === "p17") {
          character = goblin_1;
        } else if (playerid === "p19") {
          character = skeleton_1;
        } else if (playerid === "p21") {
          character = el_crystal_1;
        } else if (playerid === "p25") {
          character = el_wind_1;
        } else if (playerid === "p27") {
          character = hunter_1;
        }
      }
      const socket = io();
      var name;
      var player;
      var enemy;
      var oppName;
      var found;
      function find(element, me) {
        name = element.value;
        if (element.value == null || element.value == "") {
          alert("Enter your name");
        } else {
          socket.emit("find", { name: name, character: character });
          player = character;
          document.getElementById("loading").style.display = "block";
          me.disabled = true;
        }
      }

      socket.on("s", (e) => {
        document.querySelector(".opening").style.display = "none";
        document.querySelector("#game").style.display = "block";
        let allPlayersArray = e.allPlayers;
        console.log(allPlayersArray);
        found = allPlayersArray.find(
          (obj) => obj.p1.p1name == `${name}` || obj.p2.p2name == `${name}`
        );
        if (found.amI) {
          player = found.p2;
        }
        found.p1.p1name == `${name}`
          ? (oppName = found.p2.p2name)
          : (oppName = found.p1.p1name);
        found.p1.p1name == `${name}`
          ? (enemy = found.p2.p2char)
          : (enemy = found.p1.p1char);
        start();
      });
      console.log(found);
    </script>
  </body>
</html>
